<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Validation Stock</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Validation View -->
  <!-- Show Only if all products are validated validation=true -->
  <ion-grid *ngIf="validated">
    <ion-row style="margin-top: 20px">
      <ion-col size="6">
        <ion-button expand="block" fill="solid" style="margin-bottom: 8px" (click)="restartValidation()">Recommencer</ion-button>      
      </ion-col>
      <ion-col size="6">
      <ion-button expand="block" fill="solid" style="margin-bottom: 8px" (click)="validateStock()" >Enregistrer</ion-button>
      </ion-col>
    </ion-row>
    <ion-item *ngFor="let product of newStock">
      <ion-label>{{product.name}} {{product.stock}} / {{product.unit}}</ion-label>
    </ion-item>
  </ion-grid>

<!-- Product Showcase -->
  <ion-card-content *ngIf="!validated">
    <ion-img src="{{url}}storage/pictures/{{displayedProduct.picture}}" style="height: 200px"></ion-img>    
    <ion-row style="margin-top: 20px">
      <ion-col size="4">
        <ion-button expand="block" fill="solid" style="margin-bottom: 8px" (click)="back()"><</ion-button>
      </ion-col>
      <ion-col size="4">
        <ion-label style="font-size: large;">{{displayedProduct.name}}</ion-label>
      </ion-col>
      <ion-col size="4">      
        <ion-button expand="block" fill="solid" style="margin-bottom: 8px" (click)="next()">></ion-button>
      </ion-col>
    </ion-row>

    <ion-row>      
      <ion-col size="6">
        <ion-label style="font-size: large;">
          Stock:
          <ion-input type="number" value="{{displayedProduct.stock}}" [(ngModel)]="quantity[displayedProduct.id]" (change)="updateProductQuantity(displayedProduct.id)"></ion-input>
           / {{displayedProduct.unit}}
        </ion-label>
      </ion-col>
      <ion-col size="6"> 
      </ion-col>      
    </ion-row>
    <ion-button expand="block" fill="solid" (click)="validateProduct()">OK</ion-button>
  </ion-card-content>
</ion-content>
